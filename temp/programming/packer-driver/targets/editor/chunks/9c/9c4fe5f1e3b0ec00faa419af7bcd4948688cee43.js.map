{"version":3,"sources":["file:///E:/cocos/project/CrazyGame/assets/res/scripts/utils/oneToMultiListener.ts"],"names":["error","_decorator","ccclass","oneToMultiListener","on","eventName","handler","target","objHandler","handlerList","handlers","i","length","push","off","oldObj","splice","dispatchEvent","args","arguments","apply","setSupportEventList","arrSupportEvent","Array","supportEvent"],"mappings":"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","sourcesContent":["\r\nimport { error, _decorator } from \"cc\";\r\nconst { ccclass } = _decorator;\r\n\r\n@ccclass(\"oneToMultiListener\")\r\nexport class oneToMultiListener {\r\n    static handlers:any = {};\r\n    static supportEvent:any = {};\r\n\r\n\r\n    public static on (eventName:any, handler:any, target:any) {\r\n        var objHandler = {handler: handler, target: target};\r\n        var handlerList:any = this.handlers[eventName];\r\n        if (!handlerList) {\r\n            handlerList = [];\r\n            this.handlers[eventName] = handlerList;\r\n        }\r\n\r\n        for (var i = 0; i < handlerList.length; i++) {\r\n            if (!handlerList[i]) {\r\n                handlerList[i] = objHandler;\r\n                return i;\r\n            }\r\n        }\r\n\r\n        handlerList.push(objHandler);\r\n\r\n        return handlerList.length;\r\n    };\r\n    public static off (eventName:any, handler:any, target:any) {\r\n        var handlerList = this.handlers[eventName];\r\n\r\n        if (!handlerList) {\r\n            return;\r\n        }\r\n\r\n        for (var i = 0; i < handlerList.length; i++) {\r\n            var oldObj = handlerList[i];\r\n            if (oldObj.handler === handler && (!target || target === oldObj.target)) {\r\n                handlerList.splice(i, 1);\r\n                break;\r\n            }\r\n        }\r\n    };\r\n\r\n    public static dispatchEvent (eventName:any/**/, ...args: any) {\r\n\r\n        var handlerList = this.handlers[eventName];\r\n        var args:any = [];\r\n        var i;\r\n        for (i = 1; i < arguments.length; i++) {\r\n            args.push(arguments[i]);\r\n        }\r\n\r\n        if (!handlerList) {\r\n            return;\r\n        }\r\n\r\n        for (i = 0; i < handlerList.length; i++) {\r\n            var objHandler = handlerList[i];\r\n            if (objHandler.handler) {\r\n                objHandler.handler.apply(objHandler.target, args);\r\n            }\r\n        }\r\n    };\r\n\r\n    public static setSupportEventList (arrSupportEvent: string[]) {\r\n        if (!(arrSupportEvent instanceof Array)) {\r\n            error(\"supportEvent was not array\");\r\n            return false;\r\n        }\r\n\r\n        this.supportEvent = {};\r\n        for (var i in arrSupportEvent) {\r\n            var eventName = arrSupportEvent[i];\r\n            this.supportEvent[eventName] = i;\r\n        }\r\n    \r\n\r\n        return true;\r\n    };\r\n};\r\n"]}