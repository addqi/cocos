{"version":3,"sources":["file:///E:/cocos/project/CrazyGame/assets/script/Panel/Card.ts"],"names":["_decorator","Component","Node","ProgressBar","tween","CardManager","ccclass","property","Card","isChoose","index","cardInfo","creatCardTime","init","icon","active","ndChoose","ndProgress","setIndex","updateData","cardData","progressBar","progress","node","setPosition","position","x","initData","cardDate","creatCard","to","call","instance","creatCardInfo","start","onCardClick","updateChooseCard","updateChoose"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node, ProgressBar, TiledObjectGroup, tween } from 'cc';\r\nimport { CardManager } from '../manager/CardManager';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('Card')\r\nexport class Card extends Component {\r\n    @property(Node)\r\n    icon: Node = null;\r\n    @property(ProgressBar)\r\n    progressBar: ProgressBar = null;\r\n    @property(Node)\r\n    ndProgress: Node = null;\r\n    @property(Node)\r\n    ndChoose: Node = null;\r\n\r\n    isChoose: boolean = false;\r\n    index: number = -1;\r\n\r\n    private cardInfo: any = null;\r\n    private creatCardTime: number = 3;//创建卡牌时间\r\n\r\n    \r\n    //初始化\r\n    public init() {\r\n        this.index = -1;\r\n        this.icon.active = false;\r\n        // this.progressBar.node.active = true;\r\n        this.ndChoose.active = false;//初始化 隐藏图案\r\n        this.ndProgress.active = false;\r\n\r\n        this.isChoose = false;\r\n        // this.carInfo = null;\r\n    }\r\n    public setIndex(index) {\r\n        this.index = index;\r\n    }\r\n\r\n    updateData(cardData){\r\n        this.cardInfo = cardData;\r\n        this.progressBar.progress = 0;\r\n        if(cardData)\r\n        {\r\n            this.icon.active = true;\r\n            this.ndProgress.active =false;\r\n        }else\r\n        {\r\n            this.icon.active = false;\r\n            this.ndProgress.active =false;\r\n        }\r\n        this.isChoose =false;\r\n        this.ndChoose.active = false;\r\n        this.node.setPosition(this.node.position.x,0);\r\n    }\r\n    initData(index:number,cardDate) {\r\n\r\n        if(this.index== index)\r\n        {\r\n            this.cardInfo = cardDate;\r\n            this.icon.active = true;\r\n        }\r\n    }\r\n\r\n    creatCard(index:number){\r\n        if(this.index==index&&!this.cardInfo){\r\n            this.ndProgress.active = true;\r\n            this.progressBar.progress = 0;\r\n            let creatCardTime = this.creatCardTime;\r\n            tween(this.progressBar).to(creatCardTime,{progress:1}).call(()=>{\r\n                this.ndProgress.active = false;\r\n                this.progressBar.progress = 0;\r\n                this.cardInfo=CardManager.instance.creatCardInfo(index);\r\n                this.icon.active = true;\r\n            }).start();\r\n        }\r\n    }\r\n    public onCardClick() {\r\n        if(this.cardInfo==null){\r\n            return;\r\n        }\r\n        this.isChoose =!this.isChoose;\r\n\r\n        CardManager.instance.updateChooseCard(this.cardInfo,this.isChoose);\r\n        this.updateChoose();\r\n    }\r\n    updateChoose() {\r\n        this.ndChoose.active = this.isChoose;\r\n        if(this.isChoose){\r\n            this.node.setPosition(this.node.position.x,20);\r\n        }\r\n        else{\r\n            this.node.setPosition(this.node.position.x,0);\r\n        }\r\n    }\r\n\r\n}\r\n\r\n\r\n"]}